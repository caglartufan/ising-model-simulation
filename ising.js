// Canvas related constants
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const latticeLength = 500;
const latticeOffsetX = 2;
const latticeOffsetY = 2;
const latticeLineWidth = 1;
const graphWidth = 500;
const graphHeight = 250;
const graphOffsetX = latticeOffsetX+(2*latticeLineWidth)+latticeLength+20;
const graphOffsetY = latticeOffsetY;
const graphBorderWidth = 1;
const graphPaddingX = 30;
const graphPaddingY = 30;
var fps = 60;
var frameInterval = 1000/fps;
var startTime, now, then, elapsed;

// Canvas related functions
function renderLattice() {
    // Render borders of lattice
    ctx.beginPath();
    ctx.lineWidth = latticeLineWidth;
    ctx.strokeStyle = 'black';
    ctx.moveTo(latticeOffsetX, latticeOffsetY-latticeLineWidth);
    ctx.lineTo(latticeLength+latticeOffsetX, latticeOffsetY-latticeLineWidth);
    ctx.moveTo(latticeLength+latticeOffsetX+latticeLineWidth, latticeOffsetY-(2*latticeLineWidth));
    ctx.lineTo(latticeLength+latticeOffsetX+latticeLineWidth, latticeLength+latticeOffsetY);
    ctx.moveTo(latticeLength+latticeOffsetX+(2*latticeLineWidth), latticeLength+latticeOffsetY+latticeLineWidth);
    ctx.lineTo(latticeOffsetX, latticeLength+latticeOffsetY+latticeLineWidth);
    ctx.moveTo(latticeOffsetX-latticeLineWidth, latticeLength+latticeOffsetY+(2*latticeLineWidth));
    ctx.lineTo(latticeOffsetX-latticeLineWidth, latticeOffsetY-(2*latticeLineWidth));
    ctx.stroke();
    ctx.closePath();

    // Render each spin as red (up) and black (down) squares
    let sideLength = latticeLength/L;
    for(let i = 0; i < L; i++) {
        for(let j = 0; j < L; j++) {
            if(system[i][j] == 1) {
                ctx.fillStyle = 'blue';
            } else {
                ctx.fillStyle = 'black';
            }

            ctx.fillRect(latticeOffsetX+(j*sideLength), latticeOffsetY+(i*sideLength), sideLength, sideLength);
        }
    }
};

function renderGraph() {
    // Render borders of graph
    ctx.beginPath();
    ctx.lineWidth = graphBorderWidth;
    ctx.strokeStyle = 'black';
    ctx.moveTo(graphOffsetX, graphOffsetY-graphBorderWidth);
    ctx.lineTo(graphWidth+graphOffsetX, graphOffsetY-graphBorderWidth);
    ctx.moveTo(graphWidth+graphOffsetX+graphBorderWidth, graphOffsetY-(2*graphBorderWidth));
    ctx.lineTo(graphWidth+graphOffsetX+graphBorderWidth, graphHeight+graphOffsetY);
    ctx.moveTo(graphWidth+graphOffsetX+(2*graphBorderWidth), graphHeight+graphOffsetY+graphBorderWidth);
    ctx.lineTo(graphOffsetX, graphHeight+graphOffsetY+graphBorderWidth);
    ctx.moveTo(graphOffsetX-graphBorderWidth, graphHeight+graphOffsetY+(2*graphBorderWidth));
    ctx.lineTo(graphOffsetX-graphBorderWidth, graphOffsetY-(2*graphBorderWidth));
    ctx.stroke();
    ctx.closePath();

    // Render graph axes
    ctx.beginPath();
    ctx.lineWidth = 1;
    ctx.strokeStyle = 'red';
    ctx.moveTo(graphOffsetX+graphBorderWidth+graphPaddingX-4, graphOffsetY+graphPaddingY+10);
    ctx.lineTo(graphOffsetX+graphBorderWidth+graphPaddingX, graphOffsetY+graphPaddingY);
    ctx.lineTo(graphOffsetX+graphBorderWidth+graphPaddingX+4, graphOffsetY+graphPaddingY+10);
    ctx.moveTo(graphOffsetX+graphBorderWidth+graphPaddingX, graphOffsetY+graphPaddingY);
    ctx.lineTo(graphOffsetX+graphBorderWidth+graphPaddingX, graphOffsetY+graphHeight-graphPaddingY);
    ctx.moveTo(graphOffsetX+graphPaddingX, graphOffsetY+graphHeight-graphPaddingY+graphBorderWidth);
    ctx.lineTo(graphOffsetX+graphWidth-graphPaddingX, graphOffsetY+graphHeight-graphPaddingY+graphBorderWidth);
    ctx.moveTo(graphOffsetX+graphWidth-graphPaddingX-10, graphOffsetY+graphHeight-graphPaddingY+graphBorderWidth-4);
    ctx.lineTo(graphOffsetX+graphWidth-graphPaddingX, graphOffsetY+graphHeight-graphPaddingY+graphBorderWidth);
    ctx.lineTo(graphOffsetX+graphWidth-graphPaddingX-10, graphOffsetY+graphHeight-graphPaddingY+graphBorderWidth+4);
    ctx.stroke();
    ctx.closePath();
};

function startAnimation() {
    frameInterval = 1000/fps;
    then = Date.now();
    startTime = then;
    update();
}

function update() {
    window.requestAnimationFrame(update);

    now = Date.now();
    elapsed = now - then;

    if(elapsed > frameInterval) {
        then = now-(elapsed%frameInterval);

        if(stepsCouter < STEPS) {
            for(let i = 0; i < 10; i++) {
                if(stepsCouter < STEPS) {
                    monteCarloStep();
                }
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            renderLattice();
            renderGraph();
            updateUIElements();
        }
    }
}

// UI related constants
const spanNumberOfSpins = document.getElementById('number-of-spins');
const spanExchangeConstant = document.getElementById('exchange-constant');
const spanTemperature = document.getElementById('temperature');
const spanEnergy = document.getElementById('energy');
const spanMagnetization = document.getElementById('magnetization');
const spanSteps = document.getElementById('steps');

// UI related functions
function updateUIElements() {
    // Update span texts
    spanNumberOfSpins.innerText = N;
    spanExchangeConstant.innerText = J;
    spanTemperature.innerText = T;
    spanEnergy.innerText = energyValues[stepsCouter];
    spanMagnetization.innerText = magnetizationValues[stepsCouter];
    spanSteps.innerText = stepsCouter;
};

// Ising model related variables
var L = 32;
var N = L*L; // Total number of spins
var T = 10;
var J = 1;
const k_B = 1;
var STEPS = 1000;

var system = Array.from(new Array(L), () => new Array(L));
var randoms = [
    [
        8,
        23
    ],
    [
        3,
        8
    ],
    [
        27,
        4
    ],
    [
        13,
        18
    ],
    [
        3,
        31
    ],
    [
        17,
        1
    ],
    [
        8,
        22
    ],
    [
        22,
        22
    ],
    [
        22,
        16
    ],
    [
        12,
        1
    ],
    [
        11,
        6
    ],
    [
        3,
        11
    ],
    [
        26,
        23
    ],
    [
        28,
        20
    ],
    [
        11,
        1
    ],
    [
        29,
        5
    ],
    [
        4,
        15
    ],
    [
        6,
        16
    ],
    [
        2,
        19
    ],
    [
        28,
        0
    ],
    [
        26,
        1
    ],
    [
        16,
        26
    ],
    [
        31,
        24
    ],
    [
        18,
        31
    ],
    [
        29,
        19
    ],
    [
        22,
        15
    ],
    [
        12,
        10
    ],
    [
        5,
        31
    ],
    [
        0,
        29
    ],
    [
        14,
        10
    ],
    [
        28,
        8
    ],
    [
        22,
        9
    ],
    [
        18,
        10
    ],
    [
        3,
        8
    ],
    [
        30,
        2
    ],
    [
        1,
        15
    ],
    [
        2,
        12
    ],
    [
        25,
        3
    ],
    [
        29,
        23
    ],
    [
        1,
        28
    ],
    [
        27,
        9
    ],
    [
        21,
        22
    ],
    [
        12,
        23
    ],
    [
        15,
        11
    ],
    [
        0,
        7
    ],
    [
        29,
        3
    ],
    [
        27,
        8
    ],
    [
        16,
        3
    ],
    [
        15,
        7
    ],
    [
        6,
        31
    ],
    [
        23,
        8
    ],
    [
        23,
        21
    ],
    [
        0,
        1
    ],
    [
        27,
        13
    ],
    [
        18,
        28
    ],
    [
        20,
        15
    ],
    [
        1,
        30
    ],
    [
        5,
        15
    ],
    [
        20,
        9
    ],
    [
        31,
        20
    ],
    [
        14,
        3
    ],
    [
        24,
        28
    ],
    [
        29,
        24
    ],
    [
        15,
        11
    ],
    [
        23,
        15
    ],
    [
        21,
        15
    ],
    [
        10,
        0
    ],
    [
        15,
        4
    ],
    [
        27,
        12
    ],
    [
        13,
        4
    ],
    [
        31,
        30
    ],
    [
        20,
        1
    ],
    [
        26,
        4
    ],
    [
        31,
        18
    ],
    [
        20,
        4
    ],
    [
        1,
        31
    ],
    [
        1,
        16
    ],
    [
        28,
        11
    ],
    [
        24,
        20
    ],
    [
        6,
        28
    ],
    [
        22,
        28
    ],
    [
        1,
        18
    ],
    [
        20,
        5
    ],
    [
        20,
        18
    ],
    [
        22,
        30
    ],
    [
        12,
        4
    ],
    [
        19,
        26
    ],
    [
        8,
        18
    ],
    [
        25,
        18
    ],
    [
        1,
        2
    ],
    [
        13,
        0
    ],
    [
        1,
        26
    ],
    [
        16,
        28
    ],
    [
        18,
        17
    ],
    [
        16,
        4
    ],
    [
        5,
        0
    ],
    [
        5,
        31
    ],
    [
        25,
        28
    ],
    [
        2,
        13
    ],
    [
        19,
        24
    ],
    [
        24,
        4
    ],
    [
        16,
        25
    ],
    [
        12,
        18
    ],
    [
        15,
        28
    ],
    [
        25,
        22
    ],
    [
        26,
        26
    ],
    [
        26,
        5
    ],
    [
        10,
        29
    ],
    [
        3,
        22
    ],
    [
        20,
        31
    ],
    [
        7,
        4
    ],
    [
        14,
        3
    ],
    [
        1,
        3
    ],
    [
        14,
        12
    ],
    [
        27,
        1
    ],
    [
        22,
        25
    ],
    [
        19,
        24
    ],
    [
        21,
        13
    ],
    [
        1,
        21
    ],
    [
        22,
        2
    ],
    [
        11,
        15
    ],
    [
        9,
        0
    ],
    [
        24,
        26
    ],
    [
        3,
        14
    ],
    [
        1,
        12
    ],
    [
        10,
        22
    ],
    [
        31,
        9
    ],
    [
        13,
        9
    ],
    [
        6,
        28
    ],
    [
        25,
        0
    ],
    [
        7,
        12
    ],
    [
        16,
        15
    ],
    [
        10,
        9
    ],
    [
        26,
        3
    ],
    [
        2,
        24
    ],
    [
        18,
        4
    ],
    [
        8,
        12
    ],
    [
        13,
        0
    ],
    [
        24,
        26
    ],
    [
        4,
        1
    ],
    [
        26,
        4
    ],
    [
        22,
        16
    ],
    [
        24,
        22
    ],
    [
        6,
        13
    ],
    [
        3,
        9
    ],
    [
        11,
        16
    ],
    [
        20,
        23
    ],
    [
        22,
        19
    ],
    [
        11,
        27
    ],
    [
        18,
        28
    ],
    [
        21,
        23
    ],
    [
        19,
        1
    ],
    [
        21,
        11
    ],
    [
        16,
        15
    ],
    [
        24,
        0
    ],
    [
        21,
        21
    ],
    [
        4,
        4
    ],
    [
        24,
        13
    ],
    [
        14,
        7
    ],
    [
        18,
        12
    ],
    [
        31,
        8
    ],
    [
        26,
        10
    ],
    [
        13,
        21
    ],
    [
        11,
        17
    ],
    [
        8,
        1
    ],
    [
        12,
        30
    ],
    [
        23,
        22
    ],
    [
        14,
        10
    ],
    [
        20,
        23
    ],
    [
        21,
        19
    ],
    [
        20,
        24
    ],
    [
        24,
        28
    ],
    [
        26,
        11
    ],
    [
        1,
        26
    ],
    [
        4,
        7
    ],
    [
        17,
        14
    ],
    [
        7,
        29
    ],
    [
        9,
        23
    ],
    [
        11,
        20
    ],
    [
        18,
        27
    ],
    [
        27,
        5
    ],
    [
        24,
        5
    ],
    [
        25,
        30
    ],
    [
        21,
        19
    ],
    [
        8,
        4
    ],
    [
        31,
        23
    ],
    [
        14,
        20
    ],
    [
        2,
        15
    ],
    [
        29,
        11
    ],
    [
        5,
        2
    ],
    [
        13,
        16
    ],
    [
        13,
        22
    ],
    [
        8,
        29
    ],
    [
        28,
        16
    ],
    [
        16,
        11
    ],
    [
        23,
        5
    ],
    [
        29,
        7
    ],
    [
        0,
        17
    ],
    [
        5,
        18
    ],
    [
        4,
        17
    ],
    [
        15,
        7
    ],
    [
        19,
        5
    ],
    [
        30,
        9
    ],
    [
        31,
        13
    ],
    [
        25,
        15
    ],
    [
        16,
        1
    ],
    [
        11,
        2
    ],
    [
        29,
        21
    ],
    [
        14,
        8
    ],
    [
        26,
        0
    ],
    [
        13,
        7
    ],
    [
        0,
        22
    ],
    [
        30,
        1
    ],
    [
        31,
        19
    ],
    [
        4,
        18
    ],
    [
        19,
        18
    ],
    [
        0,
        13
    ],
    [
        21,
        25
    ],
    [
        14,
        5
    ],
    [
        14,
        29
    ],
    [
        29,
        28
    ],
    [
        6,
        20
    ],
    [
        29,
        15
    ],
    [
        9,
        20
    ],
    [
        21,
        27
    ],
    [
        6,
        17
    ],
    [
        1,
        6
    ],
    [
        25,
        30
    ],
    [
        8,
        5
    ],
    [
        31,
        0
    ],
    [
        6,
        14
    ],
    [
        1,
        4
    ],
    [
        6,
        7
    ],
    [
        28,
        3
    ],
    [
        14,
        3
    ],
    [
        5,
        9
    ],
    [
        19,
        11
    ],
    [
        7,
        20
    ],
    [
        0,
        4
    ],
    [
        11,
        26
    ],
    [
        12,
        28
    ],
    [
        0,
        4
    ],
    [
        20,
        8
    ],
    [
        3,
        5
    ],
    [
        6,
        22
    ],
    [
        31,
        1
    ],
    [
        3,
        8
    ],
    [
        23,
        29
    ],
    [
        26,
        25
    ],
    [
        4,
        28
    ],
    [
        24,
        5
    ],
    [
        25,
        0
    ],
    [
        18,
        5
    ],
    [
        10,
        14
    ],
    [
        31,
        27
    ],
    [
        28,
        12
    ],
    [
        1,
        21
    ],
    [
        20,
        29
    ],
    [
        25,
        18
    ],
    [
        25,
        0
    ],
    [
        28,
        8
    ],
    [
        16,
        14
    ],
    [
        9,
        21
    ],
    [
        23,
        25
    ],
    [
        18,
        16
    ],
    [
        21,
        13
    ],
    [
        7,
        0
    ],
    [
        21,
        28
    ],
    [
        19,
        28
    ],
    [
        7,
        30
    ],
    [
        20,
        21
    ],
    [
        17,
        19
    ],
    [
        9,
        19
    ],
    [
        2,
        5
    ],
    [
        20,
        17
    ],
    [
        30,
        16
    ],
    [
        0,
        13
    ],
    [
        23,
        28
    ],
    [
        1,
        18
    ],
    [
        20,
        1
    ],
    [
        20,
        23
    ],
    [
        24,
        3
    ],
    [
        14,
        27
    ],
    [
        14,
        31
    ],
    [
        23,
        13
    ],
    [
        23,
        17
    ],
    [
        4,
        22
    ],
    [
        5,
        19
    ],
    [
        8,
        2
    ],
    [
        15,
        7
    ],
    [
        20,
        20
    ],
    [
        30,
        28
    ],
    [
        21,
        6
    ],
    [
        30,
        18
    ],
    [
        17,
        10
    ],
    [
        14,
        28
    ],
    [
        5,
        5
    ],
    [
        29,
        10
    ],
    [
        10,
        26
    ],
    [
        24,
        0
    ],
    [
        29,
        31
    ],
    [
        6,
        29
    ],
    [
        17,
        22
    ],
    [
        5,
        6
    ],
    [
        8,
        24
    ],
    [
        23,
        15
    ],
    [
        26,
        22
    ],
    [
        25,
        10
    ],
    [
        11,
        31
    ],
    [
        21,
        22
    ],
    [
        3,
        28
    ],
    [
        31,
        18
    ],
    [
        30,
        14
    ],
    [
        22,
        23
    ],
    [
        13,
        31
    ],
    [
        31,
        26
    ],
    [
        24,
        5
    ],
    [
        22,
        24
    ],
    [
        10,
        28
    ],
    [
        25,
        20
    ],
    [
        6,
        18
    ],
    [
        1,
        7
    ],
    [
        26,
        24
    ],
    [
        21,
        31
    ],
    [
        21,
        0
    ],
    [
        27,
        19
    ],
    [
        12,
        24
    ],
    [
        5,
        3
    ],
    [
        28,
        11
    ],
    [
        15,
        2
    ],
    [
        16,
        5
    ],
    [
        5,
        10
    ],
    [
        10,
        11
    ],
    [
        2,
        23
    ],
    [
        21,
        5
    ],
    [
        24,
        8
    ],
    [
        31,
        5
    ],
    [
        9,
        2
    ],
    [
        15,
        16
    ],
    [
        5,
        15
    ],
    [
        5,
        17
    ],
    [
        2,
        26
    ],
    [
        16,
        0
    ],
    [
        18,
        6
    ],
    [
        24,
        30
    ],
    [
        13,
        19
    ],
    [
        1,
        5
    ],
    [
        15,
        15
    ],
    [
        4,
        19
    ],
    [
        9,
        30
    ],
    [
        24,
        12
    ],
    [
        1,
        14
    ],
    [
        7,
        9
    ],
    [
        3,
        13
    ],
    [
        23,
        7
    ],
    [
        19,
        21
    ],
    [
        14,
        9
    ],
    [
        14,
        23
    ],
    [
        25,
        21
    ],
    [
        15,
        18
    ],
    [
        6,
        18
    ],
    [
        1,
        0
    ],
    [
        12,
        13
    ],
    [
        31,
        29
    ],
    [
        30,
        18
    ],
    [
        9,
        4
    ],
    [
        3,
        20
    ],
    [
        12,
        10
    ],
    [
        9,
        31
    ],
    [
        11,
        18
    ],
    [
        17,
        21
    ],
    [
        23,
        8
    ],
    [
        22,
        26
    ],
    [
        1,
        6
    ],
    [
        0,
        28
    ],
    [
        22,
        13
    ],
    [
        5,
        30
    ],
    [
        23,
        1
    ],
    [
        23,
        14
    ],
    [
        7,
        10
    ],
    [
        5,
        23
    ],
    [
        30,
        10
    ],
    [
        18,
        22
    ],
    [
        19,
        27
    ],
    [
        15,
        23
    ],
    [
        1,
        15
    ],
    [
        9,
        17
    ],
    [
        14,
        5
    ],
    [
        30,
        20
    ],
    [
        19,
        0
    ],
    [
        27,
        30
    ],
    [
        20,
        21
    ],
    [
        5,
        25
    ],
    [
        24,
        9
    ],
    [
        1,
        28
    ],
    [
        3,
        30
    ],
    [
        18,
        2
    ],
    [
        6,
        22
    ],
    [
        15,
        11
    ],
    [
        0,
        0
    ],
    [
        12,
        9
    ],
    [
        15,
        16
    ],
    [
        6,
        7
    ],
    [
        23,
        12
    ],
    [
        1,
        21
    ],
    [
        6,
        0
    ],
    [
        15,
        0
    ],
    [
        4,
        6
    ],
    [
        28,
        9
    ],
    [
        15,
        8
    ],
    [
        30,
        13
    ],
    [
        6,
        14
    ],
    [
        26,
        14
    ],
    [
        7,
        1
    ],
    [
        14,
        12
    ],
    [
        5,
        21
    ],
    [
        23,
        16
    ],
    [
        16,
        14
    ],
    [
        27,
        22
    ],
    [
        12,
        17
    ],
    [
        31,
        30
    ],
    [
        18,
        22
    ],
    [
        9,
        29
    ],
    [
        12,
        18
    ],
    [
        11,
        23
    ],
    [
        10,
        29
    ],
    [
        31,
        22
    ],
    [
        11,
        6
    ],
    [
        17,
        9
    ],
    [
        18,
        19
    ],
    [
        4,
        28
    ],
    [
        18,
        0
    ],
    [
        15,
        6
    ],
    [
        6,
        13
    ],
    [
        20,
        7
    ],
    [
        10,
        29
    ],
    [
        24,
        24
    ],
    [
        25,
        1
    ],
    [
        11,
        8
    ],
    [
        0,
        5
    ],
    [
        24,
        12
    ],
    [
        20,
        23
    ],
    [
        19,
        16
    ],
    [
        30,
        20
    ],
    [
        7,
        30
    ],
    [
        28,
        4
    ],
    [
        9,
        27
    ],
    [
        26,
        23
    ],
    [
        23,
        30
    ],
    [
        10,
        18
    ],
    [
        5,
        22
    ],
    [
        5,
        29
    ],
    [
        14,
        1
    ],
    [
        17,
        3
    ],
    [
        5,
        30
    ],
    [
        3,
        1
    ],
    [
        9,
        6
    ],
    [
        27,
        2
    ],
    [
        13,
        29
    ],
    [
        4,
        26
    ],
    [
        25,
        2
    ],
    [
        11,
        7
    ],
    [
        2,
        17
    ],
    [
        16,
        6
    ],
    [
        21,
        30
    ],
    [
        27,
        18
    ],
    [
        11,
        29
    ],
    [
        10,
        28
    ],
    [
        15,
        8
    ],
    [
        21,
        31
    ],
    [
        5,
        29
    ],
    [
        13,
        23
    ],
    [
        23,
        9
    ],
    [
        25,
        29
    ],
    [
        21,
        4
    ],
    [
        31,
        29
    ],
    [
        21,
        16
    ],
    [
        18,
        18
    ],
    [
        18,
        24
    ],
    [
        10,
        14
    ],
    [
        6,
        1
    ],
    [
        28,
        17
    ],
    [
        14,
        8
    ],
    [
        16,
        10
    ],
    [
        17,
        25
    ],
    [
        3,
        30
    ],
    [
        13,
        24
    ],
    [
        12,
        7
    ],
    [
        16,
        29
    ],
    [
        6,
        18
    ],
    [
        26,
        18
    ],
    [
        26,
        4
    ],
    [
        9,
        9
    ],
    [
        31,
        27
    ],
    [
        29,
        0
    ],
    [
        6,
        18
    ],
    [
        13,
        21
    ],
    [
        6,
        11
    ],
    [
        29,
        17
    ],
    [
        31,
        5
    ],
    [
        16,
        25
    ],
    [
        18,
        17
    ],
    [
        20,
        18
    ],
    [
        16,
        17
    ],
    [
        5,
        19
    ],
    [
        26,
        26
    ],
    [
        22,
        23
    ],
    [
        29,
        1
    ],
    [
        13,
        20
    ],
    [
        3,
        7
    ],
    [
        8,
        29
    ],
    [
        22,
        12
    ],
    [
        18,
        21
    ],
    [
        10,
        16
    ],
    [
        28,
        0
    ],
    [
        3,
        19
    ],
    [
        17,
        20
    ],
    [
        22,
        19
    ],
    [
        10,
        29
    ],
    [
        6,
        16
    ],
    [
        22,
        25
    ],
    [
        28,
        4
    ],
    [
        18,
        1
    ],
    [
        22,
        17
    ],
    [
        0,
        2
    ],
    [
        23,
        8
    ],
    [
        11,
        9
    ],
    [
        17,
        25
    ],
    [
        2,
        2
    ],
    [
        6,
        11
    ],
    [
        21,
        2
    ],
    [
        2,
        17
    ],
    [
        1,
        3
    ],
    [
        25,
        4
    ],
    [
        25,
        0
    ],
    [
        21,
        19
    ],
    [
        11,
        0
    ],
    [
        7,
        28
    ],
    [
        25,
        19
    ],
    [
        12,
        8
    ],
    [
        27,
        14
    ],
    [
        10,
        25
    ],
    [
        28,
        3
    ],
    [
        29,
        31
    ],
    [
        30,
        29
    ],
    [
        28,
        9
    ],
    [
        7,
        27
    ],
    [
        16,
        26
    ],
    [
        24,
        14
    ],
    [
        28,
        12
    ],
    [
        12,
        30
    ],
    [
        5,
        25
    ],
    [
        2,
        17
    ],
    [
        6,
        4
    ],
    [
        13,
        13
    ],
    [
        6,
        5
    ],
    [
        19,
        18
    ],
    [
        23,
        14
    ],
    [
        17,
        4
    ],
    [
        25,
        2
    ],
    [
        30,
        30
    ],
    [
        11,
        16
    ],
    [
        0,
        23
    ],
    [
        15,
        21
    ],
    [
        0,
        10
    ],
    [
        10,
        0
    ],
    [
        21,
        13
    ],
    [
        16,
        10
    ],
    [
        16,
        6
    ],
    [
        30,
        20
    ],
    [
        20,
        23
    ],
    [
        30,
        25
    ],
    [
        1,
        5
    ],
    [
        1,
        11
    ],
    [
        24,
        6
    ],
    [
        9,
        9
    ],
    [
        15,
        12
    ],
    [
        19,
        30
    ],
    [
        24,
        1
    ],
    [
        20,
        31
    ],
    [
        18,
        30
    ],
    [
        4,
        2
    ],
    [
        30,
        5
    ],
    [
        29,
        8
    ],
    [
        22,
        11
    ],
    [
        30,
        22
    ],
    [
        22,
        29
    ],
    [
        30,
        27
    ],
    [
        7,
        6
    ],
    [
        2,
        0
    ],
    [
        13,
        26
    ],
    [
        30,
        5
    ],
    [
        19,
        8
    ],
    [
        31,
        6
    ],
    [
        11,
        31
    ],
    [
        3,
        10
    ],
    [
        14,
        24
    ],
    [
        4,
        1
    ],
    [
        20,
        29
    ],
    [
        8,
        3
    ],
    [
        3,
        24
    ],
    [
        3,
        23
    ],
    [
        30,
        8
    ],
    [
        10,
        8
    ],
    [
        28,
        15
    ],
    [
        6,
        5
    ],
    [
        19,
        10
    ],
    [
        2,
        12
    ],
    [
        13,
        24
    ],
    [
        2,
        24
    ],
    [
        25,
        19
    ],
    [
        0,
        24
    ],
    [
        28,
        2
    ],
    [
        14,
        5
    ],
    [
        26,
        26
    ],
    [
        14,
        14
    ],
    [
        12,
        15
    ],
    [
        19,
        10
    ],
    [
        25,
        10
    ],
    [
        31,
        28
    ],
    [
        9,
        24
    ],
    [
        23,
        17
    ],
    [
        26,
        14
    ],
    [
        31,
        18
    ],
    [
        14,
        4
    ],
    [
        20,
        23
    ],
    [
        1,
        3
    ],
    [
        15,
        29
    ],
    [
        22,
        27
    ],
    [
        26,
        0
    ],
    [
        16,
        9
    ],
    [
        8,
        11
    ],
    [
        31,
        24
    ],
    [
        8,
        23
    ],
    [
        17,
        20
    ],
    [
        21,
        20
    ],
    [
        30,
        6
    ],
    [
        9,
        28
    ],
    [
        18,
        21
    ],
    [
        0,
        3
    ],
    [
        20,
        3
    ],
    [
        7,
        24
    ],
    [
        28,
        26
    ],
    [
        27,
        18
    ],
    [
        10,
        28
    ],
    [
        27,
        13
    ],
    [
        16,
        22
    ],
    [
        25,
        10
    ],
    [
        17,
        8
    ],
    [
        31,
        18
    ],
    [
        0,
        31
    ],
    [
        23,
        24
    ],
    [
        30,
        7
    ],
    [
        4,
        9
    ],
    [
        1,
        21
    ],
    [
        2,
        27
    ],
    [
        27,
        27
    ],
    [
        28,
        21
    ],
    [
        14,
        17
    ],
    [
        13,
        25
    ],
    [
        19,
        7
    ],
    [
        27,
        10
    ],
    [
        16,
        23
    ],
    [
        10,
        29
    ],
    [
        8,
        1
    ],
    [
        11,
        11
    ],
    [
        14,
        19
    ],
    [
        1,
        12
    ],
    [
        27,
        19
    ],
    [
        20,
        26
    ],
    [
        1,
        18
    ],
    [
        21,
        12
    ],
    [
        14,
        13
    ],
    [
        4,
        12
    ],
    [
        30,
        25
    ],
    [
        16,
        27
    ],
    [
        22,
        8
    ],
    [
        28,
        31
    ],
    [
        14,
        7
    ],
    [
        16,
        20
    ],
    [
        24,
        18
    ],
    [
        3,
        25
    ],
    [
        13,
        5
    ],
    [
        8,
        14
    ],
    [
        0,
        5
    ],
    [
        26,
        31
    ],
    [
        28,
        6
    ],
    [
        5,
        13
    ],
    [
        8,
        24
    ],
    [
        24,
        4
    ],
    [
        12,
        31
    ],
    [
        7,
        3
    ],
    [
        21,
        1
    ],
    [
        18,
        14
    ],
    [
        7,
        13
    ],
    [
        20,
        29
    ],
    [
        6,
        24
    ],
    [
        6,
        9
    ],
    [
        6,
        25
    ],
    [
        8,
        3
    ],
    [
        25,
        11
    ],
    [
        18,
        13
    ],
    [
        22,
        24
    ],
    [
        14,
        14
    ],
    [
        12,
        4
    ],
    [
        29,
        5
    ],
    [
        9,
        20
    ],
    [
        7,
        30
    ],
    [
        21,
        29
    ],
    [
        9,
        4
    ],
    [
        12,
        4
    ],
    [
        12,
        20
    ],
    [
        22,
        1
    ],
    [
        17,
        1
    ],
    [
        18,
        1
    ],
    [
        4,
        31
    ],
    [
        7,
        17
    ],
    [
        12,
        15
    ],
    [
        13,
        23
    ],
    [
        24,
        24
    ],
    [
        16,
        15
    ],
    [
        4,
        10
    ],
    [
        11,
        23
    ],
    [
        6,
        1
    ],
    [
        8,
        10
    ],
    [
        9,
        7
    ],
    [
        10,
        9
    ],
    [
        7,
        4
    ],
    [
        1,
        17
    ],
    [
        31,
        27
    ],
    [
        15,
        28
    ],
    [
        0,
        20
    ],
    [
        5,
        21
    ],
    [
        21,
        27
    ],
    [
        31,
        31
    ],
    [
        14,
        28
    ],
    [
        10,
        0
    ],
    [
        14,
        24
    ],
    [
        1,
        25
    ],
    [
        4,
        31
    ],
    [
        8,
        25
    ],
    [
        4,
        21
    ],
    [
        14,
        29
    ],
    [
        24,
        17
    ],
    [
        14,
        1
    ],
    [
        10,
        1
    ],
    [
        20,
        19
    ],
    [
        7,
        9
    ],
    [
        3,
        20
    ],
    [
        20,
        17
    ],
    [
        19,
        10
    ],
    [
        11,
        9
    ],
    [
        0,
        5
    ],
    [
        4,
        4
    ],
    [
        8,
        31
    ],
    [
        20,
        5
    ],
    [
        31,
        27
    ],
    [
        30,
        7
    ],
    [
        5,
        25
    ],
    [
        23,
        19
    ],
    [
        20,
        29
    ],
    [
        2,
        26
    ],
    [
        24,
        4
    ],
    [
        21,
        24
    ],
    [
        4,
        10
    ],
    [
        5,
        13
    ],
    [
        14,
        18
    ],
    [
        10,
        4
    ],
    [
        13,
        4
    ],
    [
        30,
        2
    ],
    [
        2,
        23
    ],
    [
        12,
        13
    ],
    [
        16,
        3
    ],
    [
        0,
        9
    ],
    [
        29,
        0
    ],
    [
        0,
        15
    ],
    [
        30,
        5
    ],
    [
        27,
        0
    ],
    [
        24,
        7
    ],
    [
        30,
        28
    ],
    [
        29,
        14
    ],
    [
        10,
        2
    ],
    [
        8,
        4
    ],
    [
        23,
        15
    ],
    [
        2,
        27
    ],
    [
        15,
        12
    ],
    [
        23,
        18
    ],
    [
        4,
        18
    ],
    [
        4,
        26
    ],
    [
        5,
        22
    ],
    [
        25,
        3
    ],
    [
        6,
        22
    ],
    [
        4,
        4
    ],
    [
        25,
        26
    ],
    [
        9,
        24
    ],
    [
        31,
        4
    ],
    [
        3,
        26
    ],
    [
        27,
        31
    ],
    [
        13,
        15
    ],
    [
        10,
        24
    ],
    [
        18,
        25
    ],
    [
        7,
        2
    ],
    [
        28,
        0
    ],
    [
        28,
        2
    ],
    [
        25,
        12
    ],
    [
        3,
        16
    ],
    [
        27,
        12
    ],
    [
        31,
        1
    ],
    [
        5,
        10
    ],
    [
        25,
        4
    ],
    [
        13,
        26
    ],
    [
        12,
        1
    ],
    [
        18,
        2
    ],
    [
        17,
        19
    ],
    [
        28,
        6
    ],
    [
        21,
        10
    ],
    [
        10,
        20
    ],
    [
        16,
        6
    ],
    [
        19,
        15
    ],
    [
        0,
        9
    ],
    [
        7,
        20
    ],
    [
        2,
        31
    ],
    [
        7,
        24
    ],
    [
        7,
        6
    ],
    [
        10,
        12
    ],
    [
        20,
        31
    ],
    [
        15,
        2
    ],
    [
        5,
        23
    ],
    [
        19,
        26
    ],
    [
        29,
        25
    ],
    [
        27,
        29
    ],
    [
        13,
        8
    ],
    [
        29,
        24
    ],
    [
        31,
        31
    ],
    [
        13,
        31
    ],
    [
        20,
        9
    ],
    [
        24,
        15
    ],
    [
        17,
        2
    ],
    [
        14,
        13
    ],
    [
        28,
        2
    ],
    [
        20,
        25
    ],
    [
        21,
        24
    ],
    [
        5,
        14
    ],
    [
        22,
        21
    ],
    [
        2,
        23
    ],
    [
        11,
        15
    ],
    [
        2,
        24
    ],
    [
        28,
        24
    ],
    [
        29,
        31
    ],
    [
        19,
        3
    ],
    [
        2,
        2
    ],
    [
        19,
        18
    ],
    [
        5,
        18
    ],
    [
        13,
        28
    ],
    [
        8,
        8
    ],
    [
        21,
        26
    ],
    [
        28,
        22
    ],
    [
        31,
        13
    ],
    [
        27,
        9
    ],
    [
        1,
        25
    ],
    [
        30,
        18
    ],
    [
        16,
        31
    ],
    [
        1,
        22
    ],
    [
        11,
        5
    ],
    [
        6,
        5
    ],
    [
        18,
        27
    ],
    [
        3,
        12
    ],
    [
        20,
        5
    ],
    [
        11,
        14
    ],
    [
        20,
        28
    ],
    [
        2,
        21
    ],
    [
        1,
        26
    ],
    [
        0,
        15
    ],
    [
        17,
        17
    ],
    [
        18,
        11
    ],
    [
        23,
        11
    ],
    [
        9,
        25
    ],
    [
        22,
        10
    ],
    [
        19,
        20
    ],
    [
        4,
        31
    ],
    [
        0,
        5
    ],
    [
        11,
        19
    ],
    [
        1,
        1
    ],
    [
        23,
        28
    ],
    [
        14,
        22
    ],
    [
        18,
        18
    ],
    [
        0,
        26
    ],
    [
        29,
        20
    ],
    [
        13,
        0
    ],
    [
        18,
        31
    ],
    [
        10,
        8
    ],
    [
        29,
        26
    ],
    [
        11,
        25
    ],
    [
        26,
        7
    ],
    [
        14,
        4
    ],
    [
        11,
        20
    ],
    [
        20,
        13
    ],
    [
        11,
        6
    ],
    [
        13,
        14
    ],
    [
        11,
        12
    ],
    [
        21,
        5
    ],
    [
        10,
        25
    ],
    [
        28,
        27
    ],
    [
        1,
        7
    ],
    [
        20,
        2
    ],
    [
        23,
        9
    ],
    [
        23,
        0
    ],
    [
        15,
        31
    ],
    [
        9,
        18
    ],
    [
        27,
        17
    ],
    [
        15,
        23
    ],
    [
        27,
        16
    ],
    [
        12,
        0
    ],
    [
        8,
        18
    ],
    [
        31,
        8
    ],
    [
        30,
        9
    ],
    [
        23,
        25
    ],
    [
        23,
        31
    ],
    [
        3,
        31
    ],
    [
        28,
        27
    ],
    [
        19,
        28
    ],
    [
        24,
        7
    ],
    [
        28,
        15
    ],
    [
        19,
        29
    ],
    [
        8,
        13
    ],
    [
        27,
        28
    ],
    [
        0,
        27
    ],
    [
        4,
        27
    ],
    [
        7,
        1
    ],
    [
        24,
        17
    ],
    [
        21,
        25
    ],
    [
        30,
        23
    ],
    [
        24,
        8
    ],
    [
        21,
        19
    ],
    [
        18,
        29
    ],
    [
        23,
        1
    ],
    [
        10,
        10
    ],
    [
        27,
        14
    ],
    [
        12,
        31
    ],
    [
        7,
        13
    ],
    [
        25,
        3
    ],
    [
        22,
        4
    ],
    [
        23,
        16
    ],
    [
        20,
        21
    ],
    [
        8,
        7
    ],
    [
        8,
        14
    ],
    [
        9,
        23
    ],
    [
        21,
        8
    ],
    [
        2,
        28
    ],
    [
        19,
        20
    ],
    [
        20,
        0
    ],
    [
        17,
        9
    ],
    [
        30,
        6
    ],
    [
        10,
        13
    ],
    [
        6,
        31
    ],
    [
        13,
        4
    ],
    [
        11,
        3
    ],
    [
        14,
        27
    ],
    [
        4,
        25
    ],
    [
        7,
        19
    ],
    [
        31,
        25
    ],
    [
        6,
        22
    ],
    [
        10,
        5
    ],
    [
        16,
        31
    ],
    [
        3,
        7
    ],
    [
        24,
        21
    ],
    [
        7,
        24
    ],
    [
        10,
        11
    ],
    [
        31,
        19
    ],
    [
        5,
        27
    ],
    [
        3,
        10
    ],
    [
        17,
        27
    ],
    [
        23,
        7
    ],
    [
        1,
        27
    ],
    [
        10,
        13
    ],
    [
        22,
        3
    ],
    [
        17,
        31
    ],
    [
        1,
        9
    ],
    [
        21,
        6
    ],
    [
        4,
        29
    ],
    [
        7,
        25
    ],
    [
        18,
        19
    ],
    [
        11,
        31
    ],
    [
        8,
        9
    ],
    [
        11,
        10
    ],
    [
        15,
        29
    ],
    [
        11,
        2
    ],
    [
        30,
        24
    ],
    [
        28,
        27
    ],
    [
        10,
        22
    ],
    [
        30,
        10
    ],
    [
        13,
        11
    ],
    [
        25,
        9
    ],
    [
        29,
        1
    ],
    [
        12,
        24
    ],
    [
        17,
        14
    ],
    [
        2,
        12
    ],
    [
        13,
        11
    ],
    [
        22,
        7
    ],
    [
        27,
        18
    ]
];
var energyValues = new Array();
var magnetizationValues = new Array();
var stepsCouter = 0;

// Ising model related functions
function initializeSystem() {
    // Initialize lattice with random spins
    // for(let i = 0; i < L; i++) {
    //     for(let j = 0; j < L; j++) {
    //         if(Math.random() < 0.5) {
    //             system[i][j] = -1;
    //         } else {
    //             system[i][j] = 1;
    //         }
    //     }
    // }

    system = [
        [
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1
        ],
        [
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1
        ],
        [
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1
        ],
        [
            1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1
        ],
        [
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            -1
        ],
        [
            1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1
        ],
        [
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1
        ],
        [
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            -1
        ],
        [
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1
        ],
        [
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1
        ],
        [
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1
        ],
        [
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            -1
        ],
        [
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            -1
        ],
        [
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1
        ],
        [
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1
        ],
        [
            1,
            1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1
        ],
        [
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            -1
        ],
        [
            -1,
            -1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1
        ],
        [
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            1
        ],
        [
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1
        ],
        [
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1
        ],
        [
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1
        ],
        [
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1
        ],
        [
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            1
        ],
        [
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            -1,
            1
        ],
        [
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            1
        ],
        [
            1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            -1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            1
        ],
        [
            1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            1
        ],
        [
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1
        ],
        [
            1,
            1,
            -1,
            -1,
            1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            -1,
            1
        ],
        [
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            -1,
            1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            1,
            1,
            1,
            -1,
            -1,
            -1,
            -1,
            1
        ],
        [
            1,
            1,
            1,
            -1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            -1,
            1,
            1,
            -1,
            -1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            -1,
            1,
            1,
            -1,
            1,
            1,
            -1
        ]
    ];

    // system = [[1, -1, 1, 1],
    //           [-1, -1, 1, -1],
    //           [-1, -1, -1, 1],
    //           [-1, -1, -1, 1]];

    // Calculate initial energy and magnetization
    let { energy, magnetization } = calculateEnergyAndMagnetization();

    energyValues.push(energy);
    magnetizationValues.push(magnetization);

    updateUIElements();
    renderLattice();
};

function calculateEnergyAndMagnetization() {
    let energy = 0;
    let magnetization = 0;

    for(let i = 0; i < L; i++) {
        for(let j = 0; j < L; j++) {
            energy += -J*system[i][j]*(system[(i-1+L)%L][j]+system[i][(j+1)%L]);
            magnetization += system[i][j];
        }
    }

    return {
        energy,
        magnetization
    };
};

function monteCarloStep() {
    // let randomI = parseInt(Math.random()*L);
    // let randomJ = parseInt(Math.random()*L);
    // let randomSpin = system[randomI][randomJ];
    
    let randomI = randoms[stepsCouter][0];
    let randomJ = randoms[stepsCouter][1];
    let randomSpin = system[randomI][randomJ];

    let dE = 2*J*(randomSpin)*(system[(randomI-1+L)%L][randomJ]+system[randomI][(randomJ+1)%L]+system[(randomI+1)%L][randomJ]+system[randomI][(randomJ-1+L)%L]);
    let dM = 2*(-randomSpin);

    if(dE <= 0) {
        system[randomI][randomJ] = -randomSpin;
        energyValues.push(energyValues[stepsCouter]+dE);
        magnetizationValues.push(magnetizationValues[stepsCouter]+dM);
    } else {
        p = Math.exp(-dE/(k_B*T));
        q = Math.random();
        // console.log(`p: ${p} q: ${q}`);
        if(q <= p) {
            system[randomI][randomJ] = -randomSpin;
            energyValues.push(energyValues[stepsCouter]+dE);
            magnetizationValues.push(magnetizationValues[stepsCouter]+dM);
        } else {
            energyValues.push(energyValues[stepsCouter]);
            magnetizationValues.push(magnetizationValues[stepsCouter]);
        }
    }
    stepsCouter++;

    // console.log(`Choosen spin: system[${randomI}][${randomJ}]=${randomSpin}`);
    // console.log(`Energy before step: ${energyValues[stepsCouter]}`);
    // console.log(`dE: ${dE}`);
    // console.log(`Magnetization before step: ${magnetizationValues[stepsCouter]}`);
    // console.log(`dM: ${dM}`);
    // system[randomI][randomJ] = -randomSpin;
    // energyValues.push(energyValues[stepsCouter]-dE);
    // magnetizationValues.push(magnetizationValues[stepsCouter]+dM);
    // stepsCouter++;
    // let { energy, magnetization } = calculateEnergyAndMagnetization();
    // console.log(`Energy calculated: ${energy}`);
    // console.log(`Energy updated: ${energyValues[stepsCouter]}`);
    // console.log(`Magnetization calculated: ${magnetization}`);
    // console.log(`Magnetization updated: ${magnetizationValues[stepsCouter]}`);
};

initializeSystem();
startAnimation();